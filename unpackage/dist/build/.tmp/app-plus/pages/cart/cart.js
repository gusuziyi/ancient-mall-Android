(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cart/cart"],{"1a2d":function(t,s,e){"use strict";e.r(s);var a=e("cc7c"),o=e("ceb7");for(var i in o)"default"!==i&&function(t){e.d(s,t,function(){return o[t]})}(i);e("dda5");var n=e("2877"),c=Object(n["a"])(o["default"],a["a"],a["b"],!1,null,"2cdb90b4",null);s["default"]=c.exports},"2b96":function(t,s,e){"use strict";e.r(s);var a=e("443a"),o=e.n(a);for(var i in a)"default"!==i&&function(t){e.d(s,t,function(){return a[t]})}(i);s["default"]=o.a},"3d0c":function(t,s,e){"use strict";e.r(s);var a=e("5c21"),o=e("2b96");for(var i in o)"default"!==i&&function(t){e.d(s,t,function(){return o[t]})}(i);e("fd3a");var n=e("2877"),c=Object(n["a"])(o["default"],a["a"],a["b"],!1,null,"03f35b91",null);s["default"]=c.exports},"3e3e":function(t,s,e){"use strict";e("0460");var a=i(e("b0ce")),o=i(e("1a2d"));function i(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(o.default))},"443a":function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a=o(e("deb9"));function o(t){return t&&t.__esModule?t:{default:t}}var i=e("16c0"),n={components:{Buy:a.default},props:{pshopsArr:Array,pshopChecked:Array,likeArr:Array},filters:{formatNum:function(t){return t.toFixed(2)}},watch:{pshopsArr:{handler:function(t){this.shopsArr=t},immediate:!0,deep:!0},pshopChecked:{handler:function(t){this.shopChecked=t},immediate:!0,deep:!0}},data:function(){return{allCheck:!1,shopNum:0,tatolPrice:0,empty:"购物车竟然空无一物 ~~o(>_<)o~~",shopChecked:[],shopsArr:[],buyInfo:[],showBuy:!1}},methods:{_cancelEvent:function(){this.showBuy=!1},_confirmEvent:function(){this.showBuy=!1},onBuy:function(t,s){var e=this.shopsArr,a=e[s].shop[t],o=a.num,i={shopname:e[s].shops,name:a.name,num:a.num,size:a.sizes,type:a.types,totalPrice:(a.price*a.num).toFixed(2)};this.buyInfo=[[i],{},{},o],this.showBuy=!0},onBuyAll:function(t){var s=this.shopsArr,e=this.shopChecked,a=this.shopNum;if(a){for(var o="",i="",n=0;n<e.length;n++)for(var c=0;c<e[n].shopList.length;c++)1==e[n].shopList[c]&&(o=e[n].shops+"等",i=s[n].shop[c].name+"等");var h={shopname:o,name:i,num:a,size:"混合",type:"多类型",totalPrice:this.tatolPrice.toFixed(2)};this.buyInfo=[[h],{},{},a],this.showBuy=!0}else wx.showToast({icon:"none",title:"请选择商品"})},onDel:function(t,s,e){for(var a=this.shopsArr,o=this.shopChecked,n=0;n<a.length;n++)a[n].shops==s&&(a[n].shop.splice(t,1),o[n].shopList.splice(t,1),0==a[n].shop.length?(a.splice(n,1),o.splice(n,1),i.onRemove("cart",e)):i.onEdit("cart",e,{shop:a[n].shop}));this.setData({shopsArr:a}),this.ifAllCheck(),this.checkNum_Price(),wx.showToast({title:"删除成功"})},changeNum:function(t,s,e,a){for(var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,n=this.shopsArr,c=0;c<n.length;c++)if(n[c].shops==s){var h=n[c].shop[t].num;"down"==a?h<=1?h=1:h-=1:"up"==a?h++:"input"==a&&(console.log(o),h=o),n[c].shop[t].num=h,i.onEdit("cart",e,{shop:n[c].shop})}this.shopsArr=n,this.checkNum_Price()},ifAllCheck:function(){for(var t=!0,s=this.shopChecked,e=0;e<s.length;e++)if(0==s[e].value)return t=!1,void this.setData({allCheck:t});this.setData({allCheck:t})},checkNum_Price:function(){for(var t=0,s=0,e=this.shopChecked,a=this.shopsArr,o=0;o<e.length;o++)for(var i=0;i<e[o].shopList.length;i++)if(1==e[o].shopList[i]){t+=a[o].shop[i].num;var n=a[o].shop[i].num*a[o].shop[i].price;s+=n}this.setData({shopNum:t,tatolPrice:s})},checkShops:function(t){var s=this.shopChecked;s[t].value=!s[t].value;for(var e=0;e<s[t].shopList.length;e++)s[t].value?s[t].shopList[e]=!0:s[t].shopList[e]=!1;this.setData({shopChecked:s}),this.ifAllCheck(),this.checkNum_Price()},checkShop:function(t,s){var e=this.shopChecked;e[s].shopList[t]=!e[s].shopList[t];for(var a=!0,o=0;o<e[s].shopList.length;o++)e[s].shopList[o]||(a=!1);e[s].value=a,this.setData({shopChecked:e}),this.ifAllCheck(),this.checkNum_Price()},onallCheck:function(t){var s=this.allCheck,e=this.shopChecked;s=!s;for(var a=0;a<e.length;a++){e[a].value=!!s;for(var o=0;o<e[a].shopList.length;o++)e[a].shopList[o]=!!s}this.setData({shopChecked:e,allCheck:s}),this.checkNum_Price()},showShop:function(t){wx.navigateTo({url:"/pages/shops/shop/shop?id="+t})}}};s.default=n},"5c21":function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("view",{staticClass:"weui-cells q-cart"},[e("view",{staticClass:"q-title weui-cell"},[t.shopsArr.length?e("p",[t._v("购物车")]):t._e(),t.shopsArr.length?e("p",[t._v("共选择了"+t._s(t.shopNum)+"件商品")]):t._e()],1),e("view",{staticClass:"q-body"},[e("view",{staticClass:"q-shops"},t._l(t.shopsArr,function(s,a){return e("block",{key:a},[e("view",{staticClass:"q-shop"},[e("view",{staticClass:"weui-cell q-shop-title"},[e("radio",{staticClass:"q-radio",attrs:{value:s.shops,checked:t.shopChecked[a].value,"data-findex":"findex",color:"purple",eventid:"1809aa18-0-"+a},on:{tap:function(s){t.checkShops(a)}}}),e("view",{staticClass:"weui-cell__bd q-shopname"},[t._v(t._s(s.shops))]),e("view",{staticClass:"weui-cell-ft"},[e("navigator",{staticClass:"weui-cell weui-cell_access q-nav",attrs:{url:"../shops/shops?shops="+s.shops+"&area="+s.area,"hover-class":"weui-cell_active"}},[e("view",{staticClass:"q-more"},[t._v("进入店铺")]),e("view",{staticClass:"weui-cell__ft weui-cell__ft_in-access"})])],1)],1),t._l(s.shop,function(o,i){return e("block",{key:i},[e("view",{staticClass:"weui-cell q-shop-goods"},[e("radio",{staticClass:"q-radio",attrs:{value:o.name,"data-index":"index","data-findex":"findex","data-id":"shops._id",color:"purple",checked:t.shopChecked[a].shopList[i],eventid:"1809aa18-1-"+a+"-"+i},on:{tap:function(s){t.checkShop(i,a)}}}),e("img",{staticClass:"q-img",attrs:{src:o.imgs,"data-id":"shop.id",eventid:"1809aa18-2-"+a+"-"+i},on:{tap:function(s){t.showShop(o.id)}}}),e("view",{staticClass:"weui-cell-bd q-info"},[e("view",{attrs:{"data-id":"shop.id",eventid:"1809aa18-3-"+a+"-"+i},on:{tap:function(s){t.showShop(o.id)}}},[e("p",{staticClass:"q-name"},[t._v(t._s(o.name))]),e("p",{staticClass:"q-type"},[t._v(t._s(o.sizes)+" "+t._s(o.types))])],1),e("view",{staticClass:"q-pricenum"},[e("p",{staticClass:"q-price"},[t._v(t._s(t._f("formatNum")(o.price*o.num))+"元")]),e("view",{staticClass:"q-bottom"},[e("label",{staticClass:"q-btn-num",attrs:{"data-index":"index","data-choose":"'down'","data-shops":"shops.shops","data-id":"shops._id",eventid:"1809aa18-4-"+a+"-"+i},on:{tap:function(e){t.changeNum(i,s.shops,s._id,"down")}}},[t._v("-")]),e("input",{directives:[{name:"model",rawName:"v-model",value:o.num,expression:"shop.num"}],staticClass:"q-num",attrs:{type:"number","data-index":"index","data-choose":"'input'","data-shops":"shops.shops","data-id":"shops._id",eventid:"1809aa18-5-"+a+"-"+i},domProps:{value:o.num},on:{input:[function(t){t.target.composing||(o.num=t.target.value)},function(e){t.changeNum(i,s.shops,s._id,"input",o.num)}]}}),e("label",{staticClass:"q-btn-num",attrs:{"data-index":"index","data-choose":"up","data-shops":"shops.shops","data-id":"shops._id",eventid:"1809aa18-6-"+a+"-"+i},on:{tap:function(e){t.changeNum(i,s.shops,s._id,"up")}}},[t._v("+")])],1)],1),e("button",{staticClass:"q-btn-del",attrs:{size:"mini","data-index":"index","data-shops":"shops.shops","data-id":"shops._id",eventid:"1809aa18-7-"+a+"-"+i},on:{tap:function(e){t.onDel(i,s.shops,s._id)}}},[t._v("删除")]),e("button",{staticClass:"q-btn-buy",attrs:{size:"mini","data-index":"index","data-findex":"findex",eventid:"1809aa18-8-"+a+"-"+i},on:{tap:function(s){t.onBuy(i,a)}}},[t._v("购买")])],1)],1)])})],2)])})),e("Buy",{directives:[{name:"show",rawName:"v-show",value:t.showBuy,expression:"showBuy"}],attrs:{"buy-info":t.buyInfo,show:t.showBuy,eventid:"1809aa18-9",mpcomid:"1809aa18-0"},on:{cancelEvent:t._cancelEvent,confirmEvent:t._confirmEvent}}),t.shopsArr.length?e("view",{staticClass:"q-all"},[e("view",{staticClass:"q-left",attrs:{eventid:"1809aa18-10"},on:{tap:t.onallCheck}},[e("radio",{staticClass:"q-radio",attrs:{value:"",color:"purple",checked:t.allCheck}}),t.allCheck?e("text",{staticClass:"q-text"},[t._v("反选")]):e("text",{staticClass:"q-text"},[t._v("全选")])],1),e("view",{staticClass:"q-right"},[e("view",{staticClass:"q-text"},[t._v("共计:"),e("text",{staticClass:"q-total"},[t._v(t._s(t._f("formatNum")(t.tatolPrice))+"元")])]),e("button",{staticClass:"q-btn-account",attrs:{size:"mini",eventid:"1809aa18-11"},on:{tap:t.onBuyAll}},[t._v("结算")])],1)]):e("view",{staticClass:"q-empty"},[t._v(t._s(t.empty))])],1)])},o=[];e.d(s,"a",function(){return a}),e.d(s,"b",function(){return o})},a4fa:function(t,s,e){"use strict";(function(t){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var a=o(e("3d0c"));function o(t){return t&&t.__esModule?t:{default:t}}var i=e("16c0"),n=getApp(),c={components:{Cart:a.default},data:function(){return{shopsArr:[],shopChecked:[],favArr:[],likeArr:[]}},onLoad:function(s){n.globalData.openId?this.setData({favArr:n.globalData.favArr}):(t.showToast({title:"请登录",icon:"none",duration:2e3}),n.globalData.openId="oCCgN5OsJd1h4yLW2MTtPIzHRwV0")},onShow:function(){var t=this;wx.showLoading({title:"玩命加载中"});var s={_openid:n.globalData.openId},e=[];i.onQuery("cart",s,function(s){for(var a=0;a<s.length;a++){e.push({shops:s[a].shops,value:!1,shopList:[]});for(var o=0;o<s[a].shop.length;o++)e[a].shopList.push(!1)}t.setData({shopsArr:s,shopChecked:e}),wx.hideLoading()});var a=n.globalData.likeArr;a?this.setData({likeArr:a}):this.likeQuery()},methods:{likeQuery:function(){var t=this,s=Math.floor(200*Math.random())+150,e={sellNum:s};i.onQuery("shop",e,function(e){var a=[];e.forEach(function(t){a.push({title:"近期全网热销商品",shop:t})}),a.length>4&&(a=a.slice(0,4)),console.log("[猜你喜欢][匹配三]:热销",s,a),t.likeArr=a})}}};s.default=c}).call(this,e("6e42")["default"])},b276:function(t,s,e){},cc7c:function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("Cart",{staticClass:"cart",attrs:{"pshops-arr":t.shopsArr,"pshop-checked":t.shopChecked,"like-arr":t.likeArr,mpcomid:"7dc13ab0-0"}})},o=[];e.d(s,"a",function(){return a}),e.d(s,"b",function(){return o})},ceb7:function(t,s,e){"use strict";e.r(s);var a=e("a4fa"),o=e.n(a);for(var i in a)"default"!==i&&function(t){e.d(s,t,function(){return a[t]})}(i);s["default"]=o.a},d5eb:function(t,s,e){},dda5:function(t,s,e){"use strict";var a=e("b276"),o=e.n(a);o.a},fd3a:function(t,s,e){"use strict";var a=e("d5eb"),o=e.n(a);o.a}},[["3e3e","common/runtime","common/vendor"]]]);